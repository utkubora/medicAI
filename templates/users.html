<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>User Control</title>
    <link href="{{ url_for('static', filename='css/panels.css') }}" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <div class="">
        <div class="chatbox">
            <div class="chatbox__support">

                <div class="chatbox__header navbar">
                    <div class="navbar-left">
                        <div class="chatbox__image--header">
                            <!-- Assuming the icon's link is static and doesn't need to be served through Flask's url_for -->
                            <a href="{{ url_for('index') }}">
                                <img src="/static/images/logo.png" alt="Support Person Image">
                            </a>
                        </div>
                        <div class="chatbox__content--header">
                            <h4 class="chatbox__heading--header">Medical AI</h4>
                            <p class="chatbox__description--header">User maintanence.</p>
                        </div>
                    </div>
                    <div class="navbar-name">
                        <h4>{{ current_user.username }}</h4>
                        <a href="{{ url_for('logout') }}" class="btn btn-primary">Logout</a>
                    </div>
                </div>
                
                <div class="user-main-body ">
                    <form class="search-bar" method="POST">
                        

                            <div class="mb-3 w-100">
                                <label for="exampleInputEmail1" class="form-label">User Search</label>
                                {{ form.search(size=450,class_="form-control", id_="search-input") }}
                            </div>
                            
                            <div class="mb-3">
                                <label for="exampleInputEmail1" class="form-label"></label>
                                <a href="#" class="text-decoration-none btn btn-primary" id="search-submit">Search</a>
                            </div>
                        
                    </form>

                    <div id="previous-chats" class="user-list">
                        {% for user in users %}
                            <div class="user-card">

                                <div class="w-100">
                                    <h6> Username </h6>
                                    <h4> {{user.username}} </h4>
                                </div>

                                <select class="btn-submit form-control w-100" value="{{ user.role }}" data-id="{{ user.guid }}">
                                    <option value="admin" {% if user.role == "admin" %} selected {% endif %} >Admin</option>
                                    <option value="doctor" {% if user.role == "doctor" %} selected {% endif %} >Doctor</option>
                                    <option value="patient" {% if user.role == "patient" %} selected {% endif %} >Patient</option>
                                </select>

                            </div>    
                        {% endfor %}
                    </div>

                </div>

                <div class="footer">
                                
                </div>
            </div>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.7.1.js" integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4=" crossorigin="anonymous"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
    <script src="{{ url_for('static', filename='js/user.js') }}"></script>

    <script>
        $('#search-submit').on('click',async function(){
            console.log("{{ url_for('users_panel_filtered',filter="") }}/" + $('#search-input').val())
            window.location = "{{ url_for('users_panel_filtered',filter="") }}/" + $('#search-input').val()
        })
    </script>
</body>
</html>